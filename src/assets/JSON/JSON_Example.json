{   
    "Name":"VideoMatrixController",
    "Parameters":[   
        {   
            "Name":"#numberOfRows",
            "Type":"int",
            "DefaultValue":3
        },
        {   
            "Name":"#numberOfColumns",
            "Type":"int",
            "DefaultValue":3
        }
    ],
    "Variables":[   
        {   
            "Name":"VideoMatrix",
            "Type":"string",
            "Rank":2,
            "ArrayDimensions":[   
                "#numberOfRows",
                "#numberOfColumns"
            ],
            "DefaultValue":[   

            ]
        },
        {   
            "Name":"RowCounter",
            "Type":"int",
            "Rank":0,
            "DefaultValue":"#numberOfRows"
        },
        {   
            "Name":"IsRowFree",
            "Type":"bool",
            "Rank":0,
            "DefaultValue":false
        }
    ],
    "States":[   
        {   
            "Name":"Init",
            "Transitions":[   
                {   
                    "Name":"Init_WaitOnAlarm_Start",
                    "NextStateOnSuccess":"WaitOnAlarm",
                    "NextStateOnFailure":"WaitOnAlarm",
                    "Condition":null,
                    "Trigger":{   
                        "Message":"Start",
                        "Timeout":0
                    },
                    "Operations":[   

                    ],
                    "TransitionScenario":"StepByStep"
                }
            ]
        },
        {   
            "Name":"WaitOnAlarm",
            "Transitions":[   
                {   
                    "Name":"WaitOnAlarm_RowLoop_AlarmMessage",
                    "NextStateOnSuccess":"RowLoop",
                    "NextStateOnFailure":"RowLoop",
                    "Condition":null,
                    "Trigger":{   
                        "Message":"AlarmMessage",
                        "Timeout":0
                    },
                    "Operations":[   

                    ],
                    "TransitionScenario":"StepByStep"
                },
                {   
                    "Name":"WaitOnAlarm_End_Stop",
                    "NextStateOnSuccess":"End",
                    "NextStateOnFailure":"End",
                    "Condition":null,
                    "Trigger":{   
                        "Message":"Stop",
                        "Timeout":0
                    },
                    "Operations":[   

                    ],
                    "TransitionScenario":"StepByStep"
                }
            ]
        },
        {   
            "Name":"RowLoop",
            "Transitions":[   
                {   
                    "Name":"RowLoop_WaitOnAlarm_NO",
                    "NextStateOnSuccess":"WaitOnAlarm",
                    "NextStateOnFailure":"WaitOnAlarm",
                    "Condition":"!(RowCounter > 0)",
                    "Trigger":{   
                        "Message":null,
                        "Timeout":0
                    },
                    "Operations":[   
                        {   
                            "Name":"Assignment",
                            "Arguments":[   
                                {   
                                    "Parameter":"Assignee",
                                    "Argument":"RowCounter",
                                    "Modifier":"inout"
                                },
                                {   
                                    "Parameter":"Value",
                                    "Argument":"#numberOfRows",
                                    "Modifier":"in"
                                }
                            ]
                        }
                    ],
                    "TransitionScenario":"StepByStep"
                },
                {   
                    "Name":"RowLoop_RowIsFree_YES",
                    "NextStateOnSuccess":"RowIsFree",
                    "NextStateOnFailure":"RowIsFree",
                    "Condition":"RowCounter > 0",
                    "Trigger":{   
                        "Message":null,
                        "Timeout":0
                    },
                    "Operations":[   
                        {   
                            "Name":"CheckIfRowIsFree",
                            "Arguments":[   
                                {   
                                    "Parameter":"Matrix",
                                    "Argument":"VideoMatrix",
                                    "Modifier":"in"
                                },
                                {   
                                    "Parameter":"RowIndex",
                                    "Argument":"RowCounter",
                                    "Modifier":"in"
                                },
                                {   
                                    "Parameter":"Result",
                                    "Argument":"IsRowFree",
                                    "Modifier":"out"
                                }
                            ]
                        }
                    ],
                    "TransitionScenario":"StepByStep"
                }
            ]
        },
        {   
            "Name":"RowIsFree",
            "Transitions":[   
                {   
                    "Name":"RowIsFree_TheLastRowReached_NO",
                    "NextStateOnSuccess":"TheLastRowReached",
                    "NextStateOnFailure":"TheLastRowReached",
                    "Condition":"!(IsRowFree == true)",
                    "Trigger":{   
                        "Message":null,
                        "Timeout":0
                    },
                    "Operations":[   

                    ],
                    "TransitionScenario":"StepByStep"
                },
                {   
                    "Name":"RowIsFree_RowLoop_YES",
                    "NextStateOnSuccess":"RowLoop",
                    "NextStateOnFailure":"RowLoop",
                    "Condition":"IsRowFree == true",
                    "Trigger":{   
                        "Message":null,
                        "Timeout":0
                    },
                    "Operations":[   
                        {   
                            "Name":"Decrement",
                            "Arguments":[   
                                {   
                                    "Parameter":"Value",
                                    "Argument":"RowCounter",
                                    "Modifier":"inout"
                                }
                            ]
                        }
                    ],
                    "TransitionScenario":"StepByStep"
                }
            ]
        },
        {   
            "Name":"TheLastRowReached",
            "Transitions":[   
                {   
                    "Name":"TheLastRowReached_TheFirstRowReached_NO",
                    "NextStateOnSuccess":"TheFirstRowReached",
                    "NextStateOnFailure":"TheFirstRowReached",
                    "Condition":"!(RowCounter == #numberOfRows)",
                    "Trigger":{   
                        "Message":null,
                        "Timeout":0
                    },
                    "Operations":[   
                        {   
                            "Name":"MoveFromRowToRow",
                            "Arguments":[   
                                {   
                                    "Parameter":"From",
                                    "Argument":"RowCounter",
                                    "Modifier":"in"
                                },
                                {   
                                    "Parameter":"To",
                                    "Argument":"RowCounter+1",
                                    "Modifier":"in"
                                },
                                {   
                                    "Parameter":"Matrix",
                                    "Argument":"VideoMatrix",
                                    "Modifier":"inout"
                                }
                            ]
                        },
                        {   
                            "Name":"Decrement",
                            "Arguments":[   
                                {   
                                    "Parameter":"Value",
                                    "Argument":"RowCounter",
                                    "Modifier":"inout"
                                }
                            ]
                        }
                    ],
                    "TransitionScenario":"StepByStep"
                },
                {   
                    "Name":"TheLastRowReached_RowLoop_YES",
                    "NextStateOnSuccess":"RowLoop",
                    "NextStateOnFailure":"RowLoop",
                    "Condition":"RowCounter == #numberOfRows",
                    "Trigger":{   
                        "Message":null,
                        "Timeout":0
                    },
                    "Operations":[   
                        {   
                            "Name":"ClearRow",
                            "Arguments":[   
                                {   
                                    "Parameter":"Row",
                                    "Argument":"#numberOfRows",
                                    "Modifier":"in"
                                },
                                {   
                                    "Parameter":"Matrix",
                                    "Argument":"VideoMatrix",
                                    "Modifier":"inout"
                                }
                            ]
                        }
                    ],
                    "TransitionScenario":"StepByStep"
                }
            ]
        },
        {   
            "Name":"TheFirstRowReached",
            "Transitions":[   
                {   
                    "Name":"TheFirstRowReached_RowLoop_NO",
                    "NextStateOnSuccess":"RowLoop",
                    "NextStateOnFailure":"RowLoop",
                    "Condition":"!(RowCounter == 1)",
                    "Trigger":{   
                        "Message":null,
                        "Timeout":0
                    },
                    "Operations":[   
                        {   
                            "Name":"ShowRow",
                            "Arguments":[   
                                {   
                                    "Parameter":"Row",
                                    "Argument":"RowCounter",
                                    "Modifier":"in"
                                }
                            ]
                        },
                        {   
                            "Name":"Decrement",
                            "Arguments":[   
                                {   
                                    "Parameter":"Value",
                                    "Argument":"RowCounter",
                                    "Modifier":"inout"
                                }
                            ]
                        }
                    ],
                    "TransitionScenario":"StepByStep"
                },
                {   
                    "Name":"TheFirstRowReached_RowLoop_YES",
                    "NextStateOnSuccess":"RowLoop",
                    "NextStateOnFailure":"RowLoop",
                    "Condition":"RowCounter == 1",
                    "Trigger":{   
                        "Message":null,
                        "Timeout":0
                    },
                    "Operations":[   
                        {   
                            "Name":"Decrement",
                            "Arguments":[   
                                {   
                                    "Parameter":"Value",
                                    "Argument":"RowCounter",
                                    "Modifier":"inout"
                                }
                            ]
                        }
                    ],
                    "TransitionScenario":"StepByStep"
                }
            ]
        }
    ]
}